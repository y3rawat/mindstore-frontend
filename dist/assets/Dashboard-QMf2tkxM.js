import{u as F,r as l,f as M,j as s,s as R}from"./index-Vtja1VBs.js";import{H as T}from"./Header-JSs4fxmc.js";import{C as m}from"./ContentCard-DvhXQTgM.js";function $(){const{user:t,loading:A,signIn:U,signUp:k,logout:_}=F(),[u,N]=l.useState(""),[v,S]=l.useState(!1),[i,b]=l.useState([]),[y,g]=l.useState(!0),[E,x]=l.useState(!1),[j,h]=l.useState(null),[p,L]=l.useState(""),[f,D]=l.useState(""),[o,H]=l.useState(!1),[C,w]=l.useState("");l.useEffect(()=>{t!=null&&t.id?I():(g(!1),b([]))},[t==null?void 0:t.id]);const I=l.useCallback(async()=>{var e,a;if(t!=null&&t.id){g(!0);try{const n=await M(t.id,{limit:50,offset:0});console.log("ðŸ“¦ Dashboard loaded items:",(e=n.items)==null?void 0:e.length,(a=n.items)==null?void 0:a.slice(0,2)),n.success&&b(n.items||[])}catch(n){console.error("Failed to load content:",n)}finally{g(!1)}}},[t==null?void 0:t.id]),P=async e=>{e.preventDefault(),w("");try{o?await k(p,f):await U(p,f)}catch(a){w(a.message)}},q=async e=>{if(e.preventDefault(),!(!u.trim()||!t)){S(!0),h(null);try{const a=await R(u,t.id);a.success?(h({success:!0,message:"Content saved!"}),N(""),I(),setTimeout(()=>x(!1),1500)):h({success:!1,message:a.error||"Failed to save"})}catch(a){h({success:!1,message:a.message})}finally{S(!1)}}},r=i.filter(e=>{var a,n;return((a=e.media)==null?void 0:a.downloadStatus)==="pending"||((n=e.media)==null?void 0:n.downloadStatus)==="processing"}),c=i.filter(e=>{var a,n;return((a=e.media)==null?void 0:a.driveViewLink)||((n=e.media)==null?void 0:n.driveFileId)}),d=i.filter(e=>{var a,n;return((a=e.media)==null?void 0:a.downloadStatus)==="completed"||((n=e.media)==null?void 0:n.driveViewLink)});return l.useEffect(()=>{i.length>0&&console.log("ðŸ“Š Dashboard sections:",{total:i.length,processing:r.length,synced:c.length,recent:d.length})},[i]),A?s.jsx("div",{className:"dashboard",children:s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"loader-spinner"}),s.jsx("p",{className:"font-mono",children:"Loading..."})]})}):t?s.jsxs("div",{className:"dashboard",children:[s.jsx(T,{title:"MindStore",subtitle:"_secure.digital.assets"}),s.jsxs("main",{className:"dashboard-content",children:[r.length>0&&s.jsxs("section",{className:"section",children:[s.jsxs("div",{className:"section-header",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx("span",{className:"status-dot status-dot-processing"}),"Processing Queue"]}),s.jsx("span",{className:"section-count font-mono",children:r.length})]}),s.jsx("div",{className:"queue-list",children:r.slice(0,3).map(e=>s.jsx(m,{item:e,variant:"queue"},e.contentHash||e.id))})]}),c.length>0&&s.jsxs("section",{className:"section",children:[s.jsxs("div",{className:"section-header",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx("span",{className:"status-dot status-dot-synced"}),"Synced to Drive"]}),s.jsx("span",{className:"section-count font-mono",children:c.length})]}),s.jsx("div",{className:"content-grid",children:c.slice(0,4).map(e=>s.jsx(m,{item:e,variant:"grid"},e.contentHash||e.id))})]}),c.length===0&&d.length>0&&s.jsxs("section",{className:"section",children:[s.jsxs("div",{className:"section-header",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx("span",{className:"status-dot status-dot-local"}),"Recent Content"]}),s.jsx("span",{className:"section-count font-mono",children:d.length})]}),s.jsx("div",{className:"content-grid",children:d.slice(0,4).map(e=>s.jsx(m,{item:e,variant:"grid"},e.contentHash||e.id))})]}),i.length>0&&r.length===0&&c.length===0&&d.length===0&&s.jsxs("section",{className:"section",children:[s.jsxs("div",{className:"section-header",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx("span",{className:"status-dot status-dot-local"}),"All Content"]}),s.jsx("span",{className:"section-count font-mono",children:i.length})]}),s.jsx("div",{className:"content-grid",children:i.slice(0,8).map(e=>s.jsx(m,{item:e,variant:"grid"},e.contentHash||e.id))})]}),i.length===0&&!y&&s.jsxs("div",{className:"empty-state",children:[s.jsx("span",{className:"material-icons-round",children:"cloud_off"}),s.jsx("h3",{children:"No content yet"}),s.jsx("p",{className:"font-mono",children:"Tap + to save your first link"})]}),y&&s.jsxs("div",{className:"loading-state",children:[s.jsx("div",{className:"loader-spinner"}),s.jsx("p",{className:"font-mono",children:"Loading archives..."})]})]}),E&&s.jsx("div",{className:"modal-overlay",onClick:()=>x(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Add New Content"}),s.jsx("button",{onClick:()=>x(!1),children:s.jsx("span",{className:"material-icons-round",children:"close"})})]}),s.jsxs("form",{onSubmit:q,className:"add-form",children:[s.jsx("input",{type:"url",value:u,onChange:e=>N(e.target.value),placeholder:"Paste URL from Instagram, YouTube, Twitter...",className:"input",autoFocus:!0}),s.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:v,children:v?"Saving...":"Save Content"}),j&&s.jsx("div",{className:`result-message ${j.success?"success":"error"}`,children:j.message})]})]})})]}):s.jsx("div",{className:"dashboard",children:s.jsx("div",{className:"login-container",children:s.jsxs("div",{className:"login-card",children:[s.jsx("h1",{className:"login-title",children:"MindStore"}),s.jsx("p",{className:"login-subtitle font-mono",children:"_secure.digital.assets"}),s.jsxs("form",{onSubmit:P,className:"login-form",children:[s.jsx("input",{type:"email",value:p,onChange:e=>L(e.target.value),placeholder:"Email",className:"input",required:!0}),s.jsx("input",{type:"password",value:f,onChange:e=>D(e.target.value),placeholder:"Password",className:"input",required:!0,minLength:6}),C&&s.jsx("div",{className:"auth-error",children:C}),s.jsx("button",{type:"submit",className:"btn btn-primary btn-full",children:o?"Create Account":"Sign In"})]}),s.jsxs("p",{className:"login-toggle",children:[o?"Already have an account? ":"Don't have an account? ",s.jsx("button",{onClick:()=>H(!o),children:o?"Sign In":"Sign Up"})]})]})})})}export{$ as default};
